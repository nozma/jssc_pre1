# 確率と確率変数 {#probability_and_random_variable}

## 事象と確率 {#event_and_probability}

- **事象**（event)...おこりうる事柄のこと。
  - **全事象**または**標本空間**（sample space）...可能な結果全ての集合。$\Omega$で表す。
  - **標本点**（sample point）...全事象の元。$\omega$で表す。
  - 事象は全事象の部分集合である。
  - **空事象**（empty event）...標本点を含まない事象。$\{\}$または$\emptyset$で表す（$\phi$で代用されることが多い）。
  - **積事象**（intersection）...2つの事象$A$と$B$が両方共起こる事象。
    - $A \cap B = \{x | x \in A \land x \in B\}$
  - **和事象**（union）...2つの事象$A$と$B$の少なくともどちらかが起こる事象
    - $A \cup B = \{x | x \in A \lor x \in B\}$
  - **補集合**（complement）...$A$に属さない元の集合。$A^c$と表す。
  - **差集合**（relative complement）...$A$に属するが$B$に属さない元の集合。
    - $A \setminus B = A \cup B^c$
  - **対称差**（symmetric difference）...$A$に属し$B$に属さないものと、$B$に属し$A$に属さないものの集合。
    - $A \Delta B = (A \setminus B) \cup (B \setminus A)$
  - **ド・モルガンの法則**
    - $(A \cup B)^c = A^c \cap B^c$
    - $(A \cap B)^c = A^c \cup B^c$

- **確率**（probability）...事象$A$に対して確率$P(A)$は、区間$[0, 1]$の間の実数を対応させる関数である。
  - **集合族**...事象の集合。事象は$\Omega$の部分集合であるので、部分集合の集合ということ。
  - **可測集合族**...確率を定義できる集合族$\mathcal{B}$は、次の3つの性質を満たす必要がある。
    (1) $\emptyset \in \mathcal{B}, \Omega \in \mathcal{B}$
    (2) $A \in \mathcal{B}$ならば$A^c \in \mathcal{B}$
    (3) $A_k \in \mathcal{B}, k = 1, 2, ,...$ならば$\bigcup_{k=1}^\infty A_k \in \mathcal{B}$
  - **可測集合**...可測集合族の元。
  - **確率**（probability）...可測集合$A$に対して実数を対応する関数$P(\cdot)$で、次の条件を満たすもの。なお、2を除く条件を満たす関数を**測度**（measure）と呼ぶ。
    (1) すべての$A \in \mathcal{B}$に対して$P(A) \geq 0$
    (2) $P(\Omega) = 1$
    (3) $A_k \in \mathcal{B}, k = 1, 2, ...$が互いに排反であるとき、$P(\bigcup_{k=1}^\infty A_k) = \sum_{n=1}^\infty P(A_k)$が成り立つ
  - **確率空間**...$(\Omega, \mathcal{B}, P)$のこと。
  - **確率変数**...$\omega \in \Omega$に対して、実数値$X(\omega) \in \mathbb{R}$を対応させるような**関数**$X$のこと。任意の$x \in \mathbb{R}$について、$X \leq x$である確率は$P(\cdot)$を用いて次のように与えられる。
    - $P(X \leq x) = P(\{\omega \in \Omega | X(\omega) \leq x\})$
    - つまり、事象を実数に翻訳する関数ということである。
    - $P(\cdot)$は可測集合族$\mathcal{B}$の上に定義したものなので、厳密には$\{\omega \in \Omega | X(\omega) \leq x\} \in \mathcal{B}$でなければならない。
    - $\omega$に対して定まる値$X(\omega) = x$を**実現値**と呼ぶ。
    - 実現値全体を$\mathcal{X} = {X(\omega) | \omega \in \Omega}$で表し、$X$の**標本空間**（sample space）と呼ぶ。

### 確率の計算 {#calculate_probability}

- 確率の定義から次の性質が導かれる。
  1. $P(A^c) = 1 - P(A)$
  2. $A \subset B$ならば$P(A) \leq P(B)$
  3. $P(A \cap B) \leq min(P(A), P(B))$
  4. $P(A \cup B) = P(A) + P(B) - P(A \cap B)$

### 統計的独立 {#independence}

2つの事象$A$と$B$があったとき、片方の事象が起こるかどうかがもう片方の事象が起こるかどうかに影響を及ぼさないとき、2つの事象は**独立である**と言う。

独立であるための必要十分条件は次の式で示される。

$$
P(A \cap B) = P(A)P(B)
$$

また、条件付き確率の定義から、上記の式は次のように変形できる。

$$
P(A|B) = P(A)
$$

$$
P(B|A) = P(B)
$$

### 条件付き確率 {#conditional_probability}

2つの事象$A$と$B$があり、$P(B) > 0$のとき、次の値を$B$を与えたときの$A$の**条件付き確率**（conditional probability）と呼ぶ。

$$
P(A|B) = \frac{P(A \cap B)}{P(B)}
$$

上記の式の両辺に$P(B)$を掛けると、

$$
P(A|B)P(B) = P(A \cap B)
$$

が得られるが、同様の操作を$P(B|A)$に対しても行うことで、次の関係が得られる。

$$
P(A \cap B) = P(A|B)P(B) = P(B|A)P(A)
$$

### ベイズの定理 {#bayes_theorem}

#### 全確率の公式 {#law_of_total_probability}

$$
P(A) = \sum_{k=1}^\infty P(A|B_k)P(B_k)
$$

ただし、$B_1, B_2, ...$は互いに排反であり、$\bigcup_{k=1}^\infty B_k = \Omega$でなければならない。

#### ベイズの定理 {#bayes_tehorem_2}

$B_1, B_2, ...$は互いに排反であり、$\bigcup_{k=1}^\infty B_k = \Omega$を満たすとき、$P(B_j|A)$を次のように表す。

$$
P(B_j|A) = \frac{P(A|B_j)P(B_j)}{\sum_{k=1}^\infty P(A|B_k)P(B_k)}
$$

これを**ベイズの定理**と呼ぶ。これは、条件付き確率の関係から得られる次の式

$$
P(A|B)P(B) = P(B|A)P(A)
$$

の両辺を$P(A)$か$P(B)$で割り、分母に全確率の公式を適用することで得られる。

### 包除原理 {#PIE}

和集合の元の数を計算するには、それぞれの集合の元の数の合計から共通部分を引けば良い、というもの。数学的に扱いにくい「または」を扱いやすい「かつ」だけの式に変換できる点が優れている。

集合が2つの場合は

$$
|A \cup B| = |A| + |B| - |A \cap B|
$$

となり、3つなら

$$
|A \cup B \cup C| = |A| + |B| + |C| - |A \cap B| - |B \cap C| - |C \cap A| + |A \cap B \cap C|
$$

となる。

要するに「かつ」で繋がる集合の数が増えると、正負の記号が交互に現れる。これにより帳尻が合わせられ、共通部分は式の中で1回だけ出現することになる。

- cf. [包除原理の２通りの証明 | 高校数学の美しい物語](https://mathtrain.jp/hojo)

## 確率分布と母関数 {#probability_distribution_and_generationg_function}

### 確率関数 {#probability_mass_function}

離散型確率変数$X$に対し、

$$
f_X(x) = P(X =x)
$$

を**確率関数**（probability function）または**確率質量関数**（probability mass function; PMF）と呼ぶ。要するに確率変数の実現値をつっこむとその値に対応する確率が返ってくるような関数。

確率関数は確率であるため、次の性質を満たす点に注意しておく。

1. $0 \leq P_i \leq 1$
2. $\sum_{i=1}^n P_i = 1$（全確率）
3. $P(a \leq X \leq b) = \sum_{a \leq X_i \leq b} P_i$

また、確率関数に対して**分布関数**$F_X(x)$を次のように定義する。

$$
F_X(x) = P(X \leq x) = \sum_{x_i \leq x} P_i
$$

文章で表現すれば、上記の式は$X$が$x$以下の値になる確率を求めるための関数である。**累積分布関数**と呼ぶ場合もある。確率変数$X$が離散型であっても、分布関数の変数$x$は連続型であるという点に注意する。例えば、サイコロの目が3.5になることはありえないが、「サイコロの目が3.5以下の確率」は求めることができるのである。

### 確率密度関数 {#probability_density_function}

連続型確率変数$X$に対し、

$$
F_X(x) = \int_{-\infty}^x f_X(t) dt
$$

となるような関数$f_X(x)$を**確率密度関数**（probability density function; PDF）と呼ぶ。

確率関数と違って、連続型確率変数では確率変数が特定の値をとる確率は0となる（$P(X = x) = f_X(x)dx = 0$である）。しかし、**密度**ならば測定できる。例えば、区間$[0, 1]$の連続型一様分布を考えると、確率変数の値が厳密に0.5となる確率は0であるが、確率変数が0.5以下となる確率であれば0.5である。したがって、上記のように先に累積分布を想定しておき、その被積分関数$f_X(x)$を確率密度関数と呼ぶのである。上記一様分布の場合、確率密度関数は次のようになる。

$$
f_X(x) = 
\begin{cases}
1 & (0 \leq x \leq 1) \\
0 & (\mathrm{otherwise})
\end{cases}
$$

なお、区間$a$から$b$に対する一般の一様分布であれば次のようになる（$a \lt b$とする）。

$$
f_X(x) = 
\begin{cases}
\frac{1}{a - b} & (a \leq x \leq b) \\
0 & (\mathrm{otherwise})
\end{cases}
$$

なお、非積分値が1にならない関数も、非積分値が1になるように、すなわち区間$[-\infty, \infty]$で積分した値で割ることで確率密度関数とすることができる。このときの分母を**正規化定数**と呼ぶ。

確率密度関数の性質としては次のようなものが挙げられる。

- $f_X(x)dx = 0$...特定の値になる確率は0
- $\int_{-\infty}^\infty f_X(x)dx = 1$...全確率
- $\int_b^a f_X(x)dx = P(a \leq X \leq b)$

全ての区間にわたっての積分値が1になるという条件さえ満たしていれば、確率密度関数自体の値は1を超える場合もありうる、という点に注意すること。

### 同時確率関数

離散型確率関数$X$と$Y$があったとき、$(X, Y) = (x, y)$のときの確率を

$$
f_{XY}(x, y) = P(X = x, Y = y)
$$

とし、これを$X$と$Y$の同時確率関数と呼ぶ。

### 同時確率密度関数

### 周辺確率関数

### 周辺確率密度関数

### 条件付き確率関数

### 条件付き確率密度関数

### 累積分布関数

### 生存関数

### モーメント母関数（積率母関数）

### 確率母関数

## 分布の特性値

### モーメント

### 歪度

### 尖度

### 変動係数

### 相関係数

### 偏相関係数

### 分位点関数

### 条件付き期待値

### 条件付き分散

## 変数変換

### 変数変換

### 確率変数の線形結合の分布

## 極限定理、漸近理論

### 対数の弱法則

### 小数法則

### 中心極限定理

### 極値分布

### 二項分布の正規近似

### ポアソン分布の正規近似

### 連続修正

### デルタ法
